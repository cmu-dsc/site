---
import { Image } from "astro:assets";
import { getEntry, type CollectionEntry } from "astro:content";
import DiscordIcon from "../icons/discord.svg?raw";
import GithubIcon from "../icons/github.svg?raw";
import InstagramIcon from "../icons/instagram.svg?raw";
import LinkedinIcon from "../icons/linkedin.svg?raw";
import MailIcon from "../icons/mail.svg?raw";
import Layout from "../layouts/Layout.astro";

// Get upcoming competitions
const allCompetitions = (
  (await getEntry(
    "competitions",
    "competitions",
  )) as CollectionEntry<"competitions">
).data;

const upcoming = allCompetitions.filter((c) => c.status === "upcoming");
const featuredCompetition = upcoming[0]; // Get the first upcoming competition
---

<Layout
	title="CMU Data Science Club"
	description="Carnegie Mellon's premier AI and Data Science club. Join us for hands-on machine learning projects, research workshops, and competitions at CMU. Build your skills in artificial intelligence and data science."
>
	<main
		class="flex min-h-screen flex-col items-center justify-center text-center p-4 pt-24"
	>
		<h1 class="text-4xl md:text-5xl font-bold mb-4 text-[#082b57]">
			CMU Data Science Club
		</h1>

		<p class="text-lg md:text-xl mb-8 max-w-2xl text-[#082b57]/80">
			Carnegie Mellon's premier Artificial Intelligence club, empowering CMU
			students to explore cutting-edge AI, machine learning, and data science
			through hands-on projects, research workshops, and competitions.
		</p>

		<div class="flex flex-col items-center gap-6 mb-8">
			<a
				href="https://tartanconnect.cmu.edu/datascience/club_signup"
				class="relative inline-flex items-center justify-center group"
				data-umami-event="Mailing List Signup"
			>
				<span
					class="absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full blur-md opacity-0 group-hover:opacity-75 transition-opacity duration-300"
				></span>
				<span
					class="relative bg-[#082b57] text-white px-6 py-2 rounded-full hover:bg-[#082b57]/90 transition-colors inline-flex items-center justify-center"
				>
					<span class="w-5 h-5 mr-2" set:html={MailIcon} />
					Join our Mailing List
				</span>
			</a>

			<div class="flex gap-6">
				<a
					href="/discord"
					class="text-[#082b57] hover:text-[#082b57]/80 transition-colors"
					target="_blank"
					rel="noopener noreferrer"
					data-umami-event="Social Click - Discord"
				>
					<span class="w-8 h-8 block" set:html={DiscordIcon} />
				</a>
				<a
					href="https://instagram.com/cmudsc"
					class="text-[#082b57] hover:text-[#082b57]/80 transition-colors"
					target="_blank"
					rel="noopener noreferrer"
					data-umami-event="Social Click - Instagram"
				>
					<span class="w-8 h-8 block" set:html={InstagramIcon} />
				</a>
				<a
					href="https://github.com/cmu-dsc"
					class="text-[#082b57] hover:text-[#082b57]/80 transition-colors"
					target="_blank"
					rel="noopener noreferrer"
					data-umami-event="Social Click - Github"
				>
					<span class="w-8 h-8 block" set:html={GithubIcon} />
				</a>
				<a
					href="https://www.linkedin.com/company/cmudsc/"
					class="text-[#082b57] hover:text-[#082b57]/80 transition-colors"
					target="_blank"
					rel="noopener noreferrer"
					data-umami-event="Social Click - LinkedIn"
				>
					<span class="w-8 h-8 block" set:html={LinkedinIcon} />
				</a>
			</div>
		</div>

		{/* Featured Upcoming Competition */}
		{featuredCompetition && (
			<div class="w-full max-w-3xl mx-auto mb-12">
				<div class="bg-gradient-to-br from-[#E8F5E9] to-white rounded-xl p-8 border-2 border-[#2E7D32]/20 shadow-lg">
					<div class="flex flex-col md:flex-row gap-6 items-center">
						{featuredCompetition.thumbnail && (
							<div class="flex-shrink-0">
								<Image
									src={featuredCompetition.thumbnail}
									alt={featuredCompetition.title}
									width={120}
									height={120}
									class="rounded-lg object-cover"
								/>
							</div>
						)}
						<div class="flex-1 text-center md:text-left">
							<div class="inline-block bg-orange-100 text-orange-800 text-xs font-semibold px-3 py-1 rounded-full mb-3">
								UPCOMING COMPETITION
							</div>
							<h2 class="text-2xl md:text-3xl font-bold text-[#082b57] mb-2">
								{featuredCompetition.title}
							</h2>
							<p class="text-gray-700 mb-4 leading-relaxed">
								{featuredCompetition.description}
							</p>
							<div class="flex flex-col sm:flex-row gap-3 justify-center md:justify-start">
								<a
									href={featuredCompetition.link}
									class="inline-block bg-[#2E7D32] text-white px-6 py-3 rounded-lg hover:bg-[#1B5E20] transition-colors font-semibold text-center"
									data-umami-event="Homepage Competition Click"
								>
									Learn More â†’
								</a>
								<a
									href="/competitions"
									class="inline-block bg-white text-[#082b57] px-6 py-3 rounded-lg border-2 border-[#082b57] hover:bg-[#082b57] hover:text-white transition-colors font-semibold text-center"
									data-umami-event="View All Competitions"
								>
									View All Competitions
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		)}

		<iframe
			src="https://lu.ma/embed/calendar/cal-cfbbkSaJOwbvylo/events?lt=light"
			width="100%"
			height="450"
			style="border: none; border: 1px solid #bfcbda88; border-radius: 4px; margin: 0 auto; max-width: 600px;"
			allowfullscreen=""
			aria-hidden="false"
			tabindex="0"></iframe>
	</main>
</Layout>
